local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local function CreateLoaderScreen(text)
    local gui = Instance.new("ScreenGui")
    gui.IgnoreGuiInset = true
    gui.ResetOnSpawn = false
    gui.Name = "TriquetraDecalLoader"
    gui.Parent = playerGui

    local bg = Instance.new("Frame")
    bg.Size = UDim2.fromScale(1, 1)
    bg.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
    bg.Parent = gui

    local label = Instance.new("TextLabel")
    label.AnchorPoint = Vector2.new(0.5, 0)
    label.Position = UDim2.fromScale(0.5, 0.7)
    label.Size = UDim2.new(0, 400, 0, 40)
    label.BackgroundTransparency = 1
    label.Font = Enum.Font.GothamMedium
    label.TextColor3 = Color3.fromRGB(230, 230, 230)
    label.TextScaled = true
    label.Text = text or "Loading..."
    label.Parent = bg

    local base = Instance.new("ImageLabel")
    base.AnchorPoint = Vector2.new(0.5, 0.5)
    base.Position = UDim2.fromScale(0.5, 0.45)
    base.Size = UDim2.new(0, 200, 0, 200)
    base.BackgroundTransparency = 1
    base.Image = "rbxassetid://" .. 18671087986
    base.ImageColor3 = Color3.fromRGB(60, 60, 60)
    base.Parent = bg

    local highlight = Instance.new("ImageLabel")
    highlight.AnchorPoint = Vector2.new(0.5, 0.5)
    highlight.Position = UDim2.fromScale(0.5, 0.45)
    highlight.Size = UDim2.new(0, 200, 0, 200)
    highlight.BackgroundTransparency = 1
    highlight.Image = "rbxassetid://" .. 18671087986
    highlight.ImageColor3 = Color3.fromRGB(0, 170, 255)
    highlight.ImageTransparency = 1
    highlight.Parent = bg

    task.spawn(function()
        while gui.Parent do
            TweenService:Create(highlight, TweenInfo.new(0.6, Enum.EasingStyle.Sine), {ImageTransparency = 0}):Play()
            task.wait(0.6)
            TweenService:Create(highlight, TweenInfo.new(0.6, Enum.EasingStyle.Sine), {ImageTransparency = 1}):Play()
            task.wait(0.6)
        end
    end)

    local function FadeOut()
        TweenService:Create(bg, TweenInfo.new(0.6, Enum.EasingStyle.Sine), {BackgroundTransparency = 1}):Play()
        TweenService:Create(label, TweenInfo.new(0.6, Enum.EasingStyle.Sine), {TextTransparency = 1}):Play()
        TweenService:Create(highlight, TweenInfo.new(0.6, Enum.EasingStyle.Sine), {ImageTransparency = 1}):Play()
        TweenService:Create(base, TweenInfo.new(0.6, Enum.EasingStyle.Sine), {ImageTransparency = 1}):Play()
        task.wait(0.6)
        gui:Destroy()
    end

    return gui, FadeOut
end

return CreateLoaderScreen
