--// SAFE PLAYER + GUI SETUP
local Players = game:GetService("Players")
local player = Players.LocalPlayer

while not player do
    task.wait()
    player = Players.LocalPlayer
end

-- try gethui(), fallback to PlayerGui if invalid
local parentGui = nil

if typeof(gethui) == "function" then
    local ok, result = pcall(gethui)
    if ok and typeof(result) == "Instance" then
        parentGui = result
    end
end

if not parentGui then
    parentGui = player:WaitForChild("PlayerGui")
end

local gui = Instance.new("ScreenGui")
gui.Name = "NeonRingLoader"
gui.ResetOnSpawn = false
gui.IgnoreGuiInset = true
gui.Parent = parentGui

--// VIEWPORTFRAME
local frame = Instance.new("ViewportFrame", gui)
frame.Size = UDim2.new(0, 300, 0, 300)
frame.Position = UDim2.new(0.5, -150, 0.5, -150)
frame.BackgroundTransparency = 1

local cam = Instance.new("Camera")
frame.CurrentCamera = cam
cam.Parent = frame

--// 3D MODEL
local model = Instance.new("Model")
model.Parent = frame

local function makeRing(size, thickness, color)
    local p = Instance.new("Part")
    p.Anchored = true
    p.CanCollide = false
    p.Material = Enum.Material.Neon
    p.Color = color
    p.Shape = Enum.PartType.Cylinder
    p.Size = Vector3.new(thickness, size, size)
    p.Parent = model
    return p
end

local rings = {
    makeRing(10, 0.2, Color3.fromRGB(254, 83, 187)),
    makeRing(10, 0.2, Color3.fromRGB(143, 81, 234)),
    makeRing(10, 0.2, Color3.fromRGB(0, 68, 255)),
}

local tilts = {
    CFrame.Angles(math.rad(50), 0, 0),
    CFrame.Angles(math.rad(20), math.rad(50), 0),
    CFrame.Angles(math.rad(40), math.rad(130), 0),
}

local nucleus = Instance.new("Part")
nucleus.Shape = Enum.PartType.Ball
nucleus.Size = Vector3.new(1, 1, 1)
nucleus.Material = Enum.Material.Neon
nucleus.Color = Color3.fromRGB(254, 83, 187)
nucleus.Anchored = true
nucleus.CanCollide = false
nucleus.Parent = model

cam.CFrame = CFrame.new(Vector3.new(0, 0, 15), Vector3.new(0, 0, 0))

--// ANIMATION
local RunService = game:GetService("RunService")
local pulse = 0

RunService.RenderStepped:Connect(function(dt)
    pulse += dt * 4
    local scale = 1 + math.sin(pulse) * 0.2
    nucleus.Size = Vector3.new(scale, scale, scale)

    local t = tick()

    for i, ring in ipairs(rings) do
        local base = CFrame.new(0, 0, 0)
        local tilt = tilts[i]
        local spin = CFrame.Angles(0, 0, math.rad(t * (150 + i * 80)))
        ring.CFrame = base * tilt * spin
    end

    nucleus.CFrame = CFrame.new(0, 0, 0)
end)
