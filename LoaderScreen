-- LoaderScreen
-- Deep red animated gradient loader with particles + circle

local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local function CreateLoaderScreen(text)
    local gui = Instance.new("ScreenGui")
    gui.IgnoreGuiInset = true
    gui.ResetOnSpawn = false
    gui.Name = "HubLoading"
    gui.Parent = playerGui

    local bg = Instance.new("Frame")
    bg.Size = UDim2.fromScale(1, 1)
    bg.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    bg.Parent = gui

    -- Your colors
    local gradient = Instance.new("UIGradient")
    gradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0,   Color3.fromRGB(35, 10, 10)),
        ColorSequenceKeypoint.new(0.5, Color3.fromRGB(55, 15, 15)),
        ColorSequenceKeypoint.new(1,   Color3.fromRGB(75, 20, 20))
    })
    gradient.Rotation = 0
    gradient.Parent = bg

    TweenService:Create(
        gradient,
        TweenInfo.new(18, Enum.EasingStyle.Linear, Enum.EasingDirection.InOut, -1),
        {Rotation = 360}
    ):Play()

    local circle = Instance.new("Frame")
    circle.AnchorPoint = Vector2.new(0.5, 0.5)
    circle.Position = UDim2.fromScale(0.5, 0.45)
    circle.Size = UDim2.new(0, 120, 0, 120)
    circle.BackgroundTransparency = 1
    circle.Parent = bg

    local ring = Instance.new("ImageLabel")
    ring.AnchorPoint = Vector2.new(0.5, 0.5)
    ring.Position = UDim2.fromScale(0.5, 0.5)
    ring.Size = UDim2.new(1, 0, 1, 0)
    ring.BackgroundTransparency = 1
    ring.Image = "rbxassetid://3926305904" -- circular loader icon
    ring.ImageRectOffset = Vector2.new(4, 4)
    ring.ImageRectSize = Vector2.new(36, 36)
    ring.ImageColor3 = Color3.fromRGB(255, 40, 40)
    ring.Parent = circle

    TweenService:Create(
        ring,
        TweenInfo.new(1.2, Enum.EasingStyle.Linear, Enum.EasingDirection.InOut, -1),
        {Rotation = 360}
    ):Play()

    local label = Instance.new("TextLabel")
    label.AnchorPoint = Vector2.new(0.5, 0)
    label.Position = UDim2.fromScale(0.5, 0.62)
    label.Size = UDim2.new(0, 400, 0, 40)
    label.BackgroundTransparency = 1
    label.Font = Enum.Font.GothamBold
    label.TextColor3 = Color3.fromRGB(255, 60, 60)
    label.TextScaled = true
    label.Text = text or "Loading Assets"
    label.Parent = bg

    local particleFolder = Instance.new("Folder")
    particleFolder.Parent = bg

    local function spawnParticle()
        local p = Instance.new("Frame")
        p.Size = UDim2.new(0, math.random(2, 5), 0, math.random(2, 5))
        p.Position = UDim2.new(math.random(), 0, math.random(), 0)
        p.BackgroundColor3 = Color3.fromRGB(255, math.random(0, 40), math.random(0, 40))
        p.BackgroundTransparency = 0.15
        p.BorderSizePixel = 0
        p.Parent = particleFolder

        TweenService:Create(
            p,
            TweenInfo.new(math.random(3, 6), Enum.EasingStyle.Linear),
            {
                Position = UDim2.new(math.random(), 0, math.random(), 0),
                BackgroundTransparency = 1
            }
        ):Play()

        task.delay(6, function()
            if p then p:Destroy() end
        end)
    end

    task.spawn(function()
        while gui.Parent do
            spawnParticle()
            task.wait(0.05)
        end
    end)

    return gui
end

return CreateLoaderScreen
